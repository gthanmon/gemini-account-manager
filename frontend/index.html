<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>账号管理</title>
    <meta name="description" content="专业的账号管理系统,支持个人号和家庭组管理">
    <!-- Google Fonts: Inter (英文) + Noto Sans SC (中文) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Noto+Sans+SC:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <!-- 顶部导航 -->
    <header class="header">
        <div class="container">
            <h1 class="logo">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m7.5 4.27 9 5.15"/><path d="M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z"/><path d="m3.3 7 8.7 5 8.7-5"/><path d="M12 22V12"/></svg>
                Gemini账号管理
            </h1>
            <nav class="nav">
                <button class="notification-btn" id="notification-btn" onclick="openNotificationModal()">
                    <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9"/><path d="M10.3 21a1.94 1.94 0 0 0 3.4 0"/></svg>
                    <span class="notification-badge" id="notification-badge">0</span>
                </button>
                <button class="nav-btn active" data-view="list">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="8" x2="21" y1="6" y2="6"/><line x1="8" x2="21" y1="12" y2="12"/><line x1="8" x2="21" y1="18" y2="18"/><line x1="3" x2="3.01" y1="6" y2="6"/><line x1="3" x2="3.01" y1="12" y2="12"/><line x1="3" x2="3.01" y1="18" y2="18"/></svg>
                    <span>账号列表</span>
                </button>
                <button class="nav-btn" data-view="import" style="background: rgba(34, 197, 94, 0.1); color: var(--color-success);">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" x2="12" y1="15" y2="3"/></svg>
                    <span>导入账号</span>
                </button>
                <button class="nav-btn" onclick="openApiSettingModal()" style="background: rgba(99, 102, 241, 0.1); color: var(--color-primary-light);">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"/><circle cx="12" cy="12" r="3"/></svg>
                    <span>API设置</span>
                </button>
                <button class="nav-btn" id="logout-btn" style="margin-left: auto; background: rgba(239, 68, 68, 0.1); color: var(--color-danger);">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" x2="9" y1="12" y2="12"/></svg>
                    <span>退出登录</span>
                </button>
            </nav>
        </div>
    </header>

    <!-- 主内容区 -->
    <main class="main">
        <div class="container">

            <!-- 导入视图 -->
            <section id="import-view" class="view">
                <h2 class="section-title">
                    <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" x2="12" y1="15" y2="3"/></svg>
                    批量导入账号
                </h2>
                <div class="import-container">
                    <div class="import-form">
                        <div class="form-group">
                            <label for="batch-tag">批次标签 (可选)</label>
                            <input type="text" id="batch-tag" placeholder="例如: 2024-01-16 进货" class="input">
                        </div>
                        <div class="form-group">
                            <label for="import-text">账号数据 (每行一个)</label>
                            <textarea id="import-text" class="textarea" rows="15"
                                placeholder="支持格式:&#10;账号----密码&#10;账号----密码----辅邮&#10;账号----密码----辅邮----2FA密钥&#10;&#10;也支持使用 : 或 | 作为分隔符"></textarea>
                        </div>
                        <button id="import-btn" class="btn btn-primary">
                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" x2="12" y1="15" y2="3"/></svg>
                            开始导入
                        </button>
                    </div>
                    <div id="import-result" class="import-result"></div>
                </div>
            </section>

            <!-- 列表视图 -->
            <section id="list-view" class="view">
                <!-- 数据统计 -->
                <section class="stats-section">
                    <h2 class="section-title">
                        <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" x2="12" y1="20" y2="10"/><line x1="18" x2="18" y1="20" y2="4"/><line x1="6" x2="6" y1="20" y2="16"/></svg>
                        数据统计
                    </h2>
                    <div class="stats-grid">
                        <div class="stat-card success">
                            <div class="stat-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" x2="12" y1="2" y2="22"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg>
                            </div>
                            <div class="stat-value" id="stat-revenue">¥0</div>
                            <div class="stat-label">总收入</div>
                        </div>
                        <div class="stat-card clickable active" data-tab="personal" onclick="switchTab('personal')">
                            <div class="stat-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m7.5 4.27 9 5.15"/><path d="M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z"/><path d="m3.3 7 8.7 5 8.7-5"/><path d="M12 22V12"/></svg>
                            </div>
                            <div class="stat-value" id="stat-personal">0</div>
                            <div class="stat-label">个人号库存</div>
                        </div>
                        <div class="stat-card clickable" data-tab="sold" onclick="switchTab('sold')">
                            <div class="stat-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="8" cy="21" r="1"/><circle cx="19" cy="21" r="1"/><path d="M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12"/></svg>
                            </div>
                            <div class="stat-value" id="stat-sold">0</div>
                            <div class="stat-label">个人号已售</div>
                        </div>
                        <div class="stat-card clickable" data-tab="family" onclick="switchTab('family')">
                            <div class="stat-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
                            </div>
                            <div class="stat-value" id="stat-family">0</div>
                            <div class="stat-label">家庭组</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z"/><path d="M13 5v2"/><path d="M13 17v2"/><path d="M13 11v2"/></svg>
                            </div>
                            <div class="stat-value" id="stat-slots">0</div>
                            <div class="stat-label">车位剩余</div>
                        </div>
                        <div class="stat-card clickable warning" data-tab="banned" onclick="switchTab('banned')">
                            <div class="stat-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="m4.9 4.9 14.2 14.2"/></svg>
                            </div>
                            <div class="stat-value" id="stat-banned">0</div>
                            <div class="stat-label">异常账号</div>
                        </div>
                    </div>
                </section>

                <div class="list-header">
                    <h2 class="section-title">
                        <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="8" x2="21" y1="6" y2="6"/><line x1="8" x2="21" y1="12" y2="12"/><line x1="8" x2="21" y1="18" y2="18"/><line x1="3" x2="3.01" y1="6" y2="6"/><line x1="3" x2="3.01" y1="12" y2="12"/><line x1="3" x2="3.01" y1="18" y2="18"/></svg>
                        账号管理
                    </h2>

                    <!-- 搜索和筛选 -->
                    <div class="list-controls">
                        <div class="batch-controls">
                            <label>
                                <input type="checkbox" id="select-all-checkbox">
                                <span>全选</span>
                            </label>
                            <button id="batch-export-btn" class="btn btn-secondary" style="display: none;">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" x2="12" y1="15" y2="3"/></svg>
                                批量导出
                            </button>
                            <button id="batch-delete-btn" class="btn btn-danger" style="display: none;">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/></svg>
                                批量删除
                            </button>
                        </div>
                        <div class="search-input" style="position: relative;">
                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="position: absolute; left: 12px; top: 50%; transform: translateY(-50%); color: var(--color-text-muted);"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></svg>
                            <input type="text" id="search-input" placeholder="搜索账号、辅邮、买家信息、订单号..." class="input" style="padding-left: 40px;">
                        </div>
                        <button id="refresh-btn" class="btn btn-secondary">
                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/><path d="M21 3v5h-5"/><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"/><path d="M8 16H3v5"/></svg>
                            刷新
                        </button>
                    </div>
                </div>

                <!-- 个人号库存 -->
                <div id="personal-tab-content" class="tab-content active">
                    <div id="personal-loading" class="loading">加载中...</div>
                    <div id="personal-accounts-container" class="accounts-grid"></div>
                    <div id="personal-empty" class="empty-state">
                        <div class="empty-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m7.5 4.27 9 5.15"/><path d="M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z"/><path d="m3.3 7 8.7 5 8.7-5"/><path d="M12 22V12"/></svg>
                        </div>
                        <div class="empty-text">暂无库存</div>
                    </div>
                </div>

                <!-- 个人号已售 -->
                <div id="sold-tab-content" class="tab-content">
                    <div id="sold-loading" class="loading">加载中...</div>
                    <div id="sold-accounts-container" class="accounts-grid"></div>
                    <div id="sold-empty" class="empty-state">
                        <div class="empty-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="8" cy="21" r="1"/><circle cx="19" cy="21" r="1"/><path d="M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12"/></svg>
                        </div>
                        <div class="empty-text">暂无已售账号</div>
                    </div>
                </div>

                <!-- 家庭组 -->
                <div id="family-tab-content" class="tab-content">
                    <div id="family-loading" class="loading">加载中...</div>
                    <div id="family-accounts-container" class="accounts-grid"></div>
                    <div id="family-empty" class="empty-state">
                        <div class="empty-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
                        </div>
                        <div class="empty-text">暂无家庭组</div>
                    </div>
                </div>

                <!-- 异常账号 -->
                <div id="banned-tab-content" class="tab-content">
                    <div id="banned-loading" class="loading">加载中...</div>
                    <div id="banned-accounts-container" class="accounts-grid"></div>
                    <div id="banned-empty" class="empty-state">
                        <div class="empty-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="m4.9 4.9 14.2 14.2"/></svg>
                        </div>
                        <div class="empty-text">暂无异常账号</div>
                    </div>
                </div>
            </section>

        </div>
    </main>

    <!-- Toast 提示 -->
    <div id="toast" class="toast"></div>

    <!-- 车位编辑弹窗 -->
    <div id="slot-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modal-title">
                    <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2"/><circle cx="7" cy="17" r="2"/><path d="M9 17h6"/><circle cx="17" cy="17" r="2"/></svg>
                    发车 - 分配车位
                </h3>
                <button class="modal-close" onclick="closeSlotModal()">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="buyer-name">买家信息 *</label>
                    <input type="text" id="buyer-name" class="input" placeholder="买家昵称或备注">
                </div>
                <div class="form-group">
                    <label for="buyer-source">买家来源</label>
                    <input type="text" id="buyer-source" class="input" placeholder="例如: 闲鱼、淘宝、微信">
                </div>
                <div class="form-group">
                    <label for="invite-email">邀请邮箱</label>
                    <input type="email" id="invite-email" class="input" placeholder="买家的 Google 邮箱">
                </div>
                <div class="form-group">
                    <label for="slot-price">金额 (可选)</label>
                    <input type="text" id="slot-price" class="input" placeholder="例如: 50">
                </div>
                <div class="form-group" id="expire-days-group">
                    <label for="expire-days">服务期限 (天，不填则无限)</label>
                    <input type="number" id="expire-days" class="input" placeholder="例如: 31" min="1">
                </div>
                <div class="form-group" id="slot-time-group" style="display: none;">
                    <label>上车时间</label>
                    <div id="slot-assigned-time" style="padding: 8px; background: rgba(59, 130, 246, 0.1); border-radius: 8px; color: var(--color-info);"></div>
                </div>
                <div class="form-group" id="slot-expire-info-group" style="display: none;">
                    <label>到期时间</label>
                    <div id="slot-expire-time" style="padding: 8px; background: rgba(245, 158, 11, 0.1); border-radius: 8px; color: var(--color-warning);"></div>
                </div>
                <!-- 邀请状态显示 -->
                <div class="form-group" id="invite-status-group" style="display: none;">
                    <label>邀请状态</label>
                    <div id="invite-status" style="padding: 8px; background: rgba(34, 197, 94, 0.1); border-radius: 8px; color: var(--color-success);"></div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="slot-edit-btn" onclick="enableSlotEdit()" style="display: none;">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z"/><path d="m15 5 4 4"/></svg>
                    编辑
                </button>
                <button class="btn" id="auto-invite-btn" onclick="autoSendInvite()" style="background: var(--gradient-accent); color: white;">自动发送邀请</button>
                <button class="btn" id="auto-remove-btn" onclick="autoRemoveMember()" style="display: none; background: linear-gradient(135deg, #f59e0b, #ef4444); color: white;">自动踢出</button>
                <button class="btn" id="slot-renew-btn" onclick="openRenewInput()" style="display: none; background: var(--gradient-accent); color: white;">续费</button>
                <button class="btn btn-primary" id="slot-confirm-btn" onclick="confirmSlotAction()">确认</button>
                <button class="btn btn-danger" id="slot-release-btn" style="display: none;" onclick="confirmRelease()">下车</button>
            </div>
        </div>
    </div>

    <!-- 个人号售出弹窗 -->
    <div id="sell-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>
                    <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" x2="12" y1="2" y2="22"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg>
                    标记为已售出
                </h3>
                <button class="modal-close" onclick="closeSellModal()">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="sell-buyer-name">买家昵称 *</label>
                    <input type="text" id="sell-buyer-name" class="input" placeholder="买家昵称或备注">
                </div>
                <div class="form-group">
                    <label for="sell-buyer-source">买家来源</label>
                    <input type="text" id="sell-buyer-source" class="input" placeholder="例如: 闲鱼、淘宝、微信">
                </div>
                <div class="form-group">
                    <label for="sell-order-number">订单号 (可选)</label>
                    <input type="text" id="sell-order-number" class="input" placeholder="订单编号">
                </div>
                <div class="form-group">
                    <label for="sell-price">售价 (可选)</label>
                    <input type="text" id="sell-price" class="input" placeholder="例如: 50元">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeSellModal()">取消</button>
                <button class="btn btn-primary" id="sell-confirm-btn" onclick="confirmSell()">确认售出</button>
            </div>
        </div>
    </div>

    <!-- 编辑售出信息弹窗 -->
    <div id="edit-sold-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>
                    <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z"/><path d="m15 5 4 4"/></svg>
                    编辑售出信息
                </h3>
                <button class="modal-close" onclick="closeEditSoldModal()">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="edit-sold-buyer-name">买家昵称 *</label>
                    <input type="text" id="edit-sold-buyer-name" class="input" placeholder="买家昵称或备注">
                </div>
                <div class="form-group">
                    <label for="edit-sold-buyer-source">买家来源</label>
                    <input type="text" id="edit-sold-buyer-source" class="input" placeholder="例如: 闲鱼、淘宝、微信">
                </div>
                <div class="form-group">
                    <label for="edit-sold-price">售价 (可选)</label>
                    <input type="text" id="edit-sold-price" class="input" placeholder="例如: 50元">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeEditSoldModal()">取消</button>
                <button class="btn btn-primary" onclick="confirmEditSold()">保存</button>
            </div>
        </div>
    </div>

    <!-- 封禁原因弹窗 -->
    <div id="ban-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>
                    <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="m4.9 4.9 14.2 14.2"/></svg>
                    标记为异常
                </h3>
                <button class="modal-close" onclick="closeBanModal()">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="ban-reason">异常原因 *</label>
                    <textarea id="ban-reason" class="textarea" rows="3" placeholder="请输入异常原因,如:被封号、密码错误、2FA失效等"></textarea>
                </div>
                <div class="form-group">
                    <label for="ban-note">备注 (可选)</label>
                    <input type="text" id="ban-note" class="input" placeholder="额外备注信息">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeBanModal()">取消</button>
                <button class="btn btn-danger" onclick="confirmBan()">确认标记</button>
            </div>
        </div>
    </div>

    <!-- 取消售出确认弹窗 -->
    <div id="cancel-sold-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>
                    <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 7v6h6"/><path d="M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13"/></svg>
                    取消售出
                </h3>
                <button class="modal-close" onclick="closeCancelSoldModal()">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>
                </button>
            </div>
            <div class="modal-body">
                <p style="color: var(--color-text-secondary); line-height: 1.6; margin-bottom: var(--space-lg);">
                    确定要取消售出吗？
                </p>
                <p style="color: var(--color-text-muted); font-size: 0.9rem; line-height: 1.5;">
                    取消后，账号将恢复为库存状态，售出信息将被清除。
                </p>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeCancelSoldModal()">取消</button>
                <button class="btn btn-primary" onclick="confirmCancelSold()">确认取消售出</button>
            </div>
        </div>
    </div>

    <!-- 到期提醒弹窗 -->
    <div id="notification-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>
                    <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9"/><path d="M10.3 21a1.94 1.94 0 0 0 3.4 0"/></svg>
                    到期提醒
                </h3>
                <button class="modal-close" onclick="closeNotificationModal()">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>
                </button>
            </div>
            <div class="modal-body">
                <div id="notification-list" style="max-height: 400px; overflow-y: auto;">
                    <!-- 通知列表由 JS 动态生成 -->
                </div>
                <div id="notification-empty" style="text-align: center; padding: 2rem; color: var(--color-text-muted);">
                    <div style="font-size: 3rem; margin-bottom: 1rem;">
                        <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><path d="m9 11 3 3L22 4"/></svg>
                    </div>
                    <div>暂无到期提醒</div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="markAllNotificationsRead()" id="mark-read-btn" style="margin-right: auto;">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 6 9 17l-5-5"/></svg>
                    全部已读
                </button>
                <button class="btn btn-secondary" onclick="closeNotificationModal()">关闭</button>
            </div>
        </div>
    </div>

    <!-- API 设置弹窗 -->
    <div id="api-setting-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>
                    <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"/><circle cx="12" cy="12" r="3"/></svg>
                    本地 API 设置
                </h3>
                <button class="modal-close" onclick="closeApiSettingModal()">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="api-url-input">API 地址</label>
                    <input type="text" id="api-url-input" class="input" placeholder="https://web.xxxx.com">
                    <p style="color: var(--color-text-muted); font-size: 0.85rem; margin-top: 8px;">
                        填写你的 Cloudflared 隧道地址，用于自动发送家庭组邀请
                    </p>
                </div>
                <div class="form-group">
                    <label>当前状态</label>
                    <div id="api-status" style="padding: 8px; background: rgba(245, 158, 11, 0.1); border-radius: 8px; color: var(--color-warning);">
                        未配置
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeApiSettingModal()">取消</button>
                <button class="btn" onclick="testApiConnection()" style="background: rgba(59, 130, 246, 0.1); color: var(--color-info);">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/></svg>
                    测试连接
                </button>
                <button class="btn btn-primary" onclick="saveApiSetting()">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 6 9 17l-5-5"/></svg>
                    保存
                </button>
            </div>
        </div>
    </div>

    <!-- 续费弹窗 -->
    <div id="renew-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>
                    <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/><path d="M21 3v5h-5"/><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"/><path d="M8 16H3v5"/></svg>
                    续费
                </h3>
                <button class="modal-close" onclick="closeRenewModal()">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="renew-days">续费天数</label>
                    <input type="number" id="renew-days" class="input" placeholder="例如: 31" min="1" value="31">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeRenewModal()">取消</button>
                <button class="btn btn-primary" onclick="confirmRenew()">确认续费</button>
            </div>
        </div>
    </div>

    <!-- 删除支付资料确认弹窗 -->
    <div id="delete-payment-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>
                    <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="20" height="14" x="2" y="5" rx="2"/><line x1="2" x2="22" y1="10" y2="10"/></svg>
                    删除支付资料
                </h3>
                <button class="modal-close" onclick="closeDeletePaymentModal()">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>
                </button>
            </div>
            <div class="modal-body">
                <p style="color: var(--color-text-secondary); line-height: 1.6; margin-bottom: var(--space-lg);">
                    确定要删除 <strong id="delete-payment-email"></strong> 的支付资料吗？
                </p>
                <p style="color: var(--color-text-muted); font-size: 0.9rem; line-height: 1.5;">
                    此操作将关闭该账号的 Google 支付资料，操作不可逆。
                </p>
                <!-- 操作状态显示 -->
                <div class="form-group" id="delete-payment-status-group" style="display: none; margin-top: 1rem;">
                    <label>操作状态</label>
                    <div id="delete-payment-status" style="padding: 8px; background: rgba(245, 158, 11, 0.1); border-radius: 8px; color: var(--color-warning);"></div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeDeletePaymentModal()">取消</button>
                <button class="btn btn-danger" id="delete-payment-confirm-btn" onclick="confirmDeletePayment()">确认删除</button>
            </div>
        </div>
    </div>

    <!-- 通用确认弹窗 -->
    <div id="confirm-modal" class="modal">
        <div class="modal-content" style="max-width: 400px;">
            <div class="modal-header">
                <h3 id="confirm-modal-title">
                    <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="M12 16v-4"/><path d="M12 8h.01"/></svg>
                    确认操作
                </h3>
                <button class="modal-close" onclick="closeConfirmModal()">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>
                </button>
            </div>
            <div class="modal-body">
                <p id="confirm-modal-message" style="color: var(--color-text-secondary); line-height: 1.6; text-align: center;"></p>
            </div>
            <div class="modal-footer" style="justify-content: center;">
                <button class="btn btn-secondary" onclick="closeConfirmModal()">取消</button>
                <button class="btn btn-danger" id="confirm-modal-btn" onclick="executeConfirmAction()">确认</button>
            </div>
        </div>
    </div>

    <!-- 编辑账号弹窗 -->
    <div id="edit-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>
                    <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z"/><path d="m15 5 4 4"/></svg>
                    编辑账号
                </h3>
                <button class="modal-close" onclick="closeEditModal()">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="edit-email">账号邮箱</label>
                    <input type="email" id="edit-email" class="input" disabled>
                </div>
                <div class="form-group">
                    <label for="edit-password">密码</label>
                    <input type="text" id="edit-password" class="input" placeholder="输入新密码">
                </div>
                <div class="form-group">
                    <label for="edit-backup-email">辅助邮箱 (可选)</label>
                    <input type="email" id="edit-backup-email" class="input" placeholder="辅助邮箱">
                </div>
                <div class="form-group">
                    <label for="edit-twofa">2FA 密钥 (可选)</label>
                    <input type="text" id="edit-twofa" class="input" placeholder="TOTP 密钥">
                </div>
                <div class="form-group">
                    <label for="edit-batch-tag">批次标签 (可选)</label>
                    <input type="text" id="edit-batch-tag" class="input" placeholder="例如: 1.24">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeEditModal()">取消</button>
                <button class="btn btn-primary" onclick="confirmEdit()">保存</button>
            </div>
        </div>
    </div>

    <script src="config.js"></script>
    <script src="icons.js"></script>
    <script src="app.js"></script>
</body>

</html>
