# ğŸš€ Account Manager - Open Source

ä¸€ä¸ªåŸºäº Cloudflare Workers + D1 + Pages çš„è´¦å·ç®¡ç†ç³»ç»Ÿã€‚æ”¯æŒä¸ªäººå·åº“å­˜ç®¡ç†ã€å®¶åº­ç»„è½¦ä½ç®¡ç†ã€å”®å‡ºè®°å½•ã€å¤šç”¨æˆ·éš”ç¦»ç­‰åŠŸèƒ½ã€‚

> **âš ï¸ æ³¨æ„**: æœ¬é¡¹ç›®**ä¸åŒ…æ‹¬**ä»»ä½•ç›´æ¥ç™»å½•ç¬¬ä¸‰æ–¹å¹³å°è´¦å·çš„è‡ªåŠ¨åŒ–é€»è¾‘ã€‚å®ƒä»…ä½œä¸ºä¸€ä¸ªåº“å­˜è®°å½•å’Œåˆ†å‘ç®¡ç†å·¥å…·ä½¿ç”¨ã€‚

## âœ¨ ç‰¹æ€§

- **æ— æœåŠ¡å™¨æ¶æ„**: å®Œå…¨åŸºäº Cloudflare ç”Ÿæ€ï¼Œå…è´¹ã€å³æ—¶æ‰©ç¼©å®¹ã€‚
- **å¤šç”¨æˆ·æ”¯æŒ**: ç”¨æˆ·æ³¨å†Œ/ç™»å½• (SHA-256)ï¼Œæ•°æ®éš”ç¦»ã€‚
- **åº“å­˜ç®¡ç†**: å¯¼å…¥è´¦å·ã€åŒºåˆ†ä¸ªäººå·/å®¶åº­ç»„ã€‚
- **è½¦ä½ç®¡ç†**: å®¶åº­ç»„ 5 è½¦ä½åˆ†é…ã€é‡Šæ”¾ã€è®°å½•ä¹°å®¶ä¿¡æ¯ã€‚
- **å”®å‡ºè®°å½•**: ä¸ªäººå·å”®å‡ºæ ‡è®°ã€æ”¶å…¥ç»Ÿè®¡ã€‚
- **å®‰å…¨**: 2FA å¯†é’¥å­˜å‚¨ä¸ (å®éªŒæ€§) TOTP æŸ¥çœ‹ã€‚
- **ç§»åŠ¨ç«¯ä¼˜åŒ–**: å®Œç¾é€‚é…æ‰‹æœºå±å¹•ï¼Œæ”¯æŒå¸ƒå±€è‡ªåŠ¨è°ƒæ•´ä¸é•¿æ–‡æœ¬æ¢è¡Œã€‚

## ğŸ› ï¸ éƒ¨ç½²æŒ‡å—

### å‰ç½®è¦æ±‚
1. Cloudflare è´¦å·
2. Node.js (v18+)
3. Wrangler CLI (`npm install -g wrangler`)

### 1. å‡†å¤‡ä»£ç 
å…‹éš†æˆ–ä¸‹è½½æœ¬é¡¹ç›®ã€‚

### 2. åˆ›å»ºæ•°æ®åº“
```bash
wrangler d1 create account-manager-db
```
è®°ä¸‹è¾“å‡ºä¸­çš„ `database_id`ã€‚

### 3. é…ç½®åç«¯
1. ç¼–è¾‘ `worker/wrangler.toml`ï¼Œå°† `database_id` æ›¿æ¢ä¸ºä½ åˆšæ‰åˆ›å»ºçš„ IDã€‚
2. **é‡è¦**: ç¼–è¾‘ `worker/src/routes/auth.js`ï¼Œæœç´¢ `admin123`ï¼Œå°†å…¶ä¿®æ”¹ä¸ºä½ è‡ªå·±çš„å¼ºå¯†ç ã€‚è¿™æ˜¯é¢„è®¾çš„ç®¡ç†å‘˜å¯†ç ã€‚

### 4. åˆå§‹åŒ–æ•°æ®åº“
```bash
cd worker
wrangler d1 execute account-manager-db --remote --file=../schema.sql
```

### 5. éƒ¨ç½²åç«¯ Worker
```bash
# åœ¨ worker ç›®å½•ä¸‹
wrangler deploy
```
éƒ¨ç½²æˆåŠŸåè·å– Worker URL (ä¾‹å¦‚ `https://account-manager-worker.xxx.workers.dev`)ã€‚

### 6. é…ç½®å‰ç«¯
ç¼–è¾‘ `frontend/config.js`ï¼š
```javascript
// ç¯å¢ƒå¼€å…³: true=æœ¬åœ°å¼€å‘, false=è¿œç¨‹ç”Ÿäº§
const USE_LOCAL = false;

// åœ°å€é…ç½®
const LOCAL_URL = 'http://localhost:8787';
const REMOTE_URL = 'https://your-worker.xxx.workers.dev'; // æ›¿æ¢ä¸ºä½ çš„ Worker URL
```
**åªéœ€ä¿®æ”¹æ­¤æ–‡ä»¶ï¼Œåˆ‡æ¢ `USE_LOCAL` å³å¯åœ¨æœ¬åœ°å’Œè¿œç¨‹ç¯å¢ƒé—´åˆ‡æ¢ã€‚**

### 7. éƒ¨ç½²å‰ç«¯ Pages
```bash
cd frontend
wrangler pages deploy . --project-name=account-manager
```
è®¿é—®è·å¾—çš„ Pages URL å³å¯ä½¿ç”¨ã€‚

## ğŸ” ç™»å½•ä¸å®‰å…¨

### é»˜è®¤ç®¡ç†å‘˜
ç³»ç»Ÿé¢„è®¾äº†ä¸€ä¸ªç¡¬ç¼–ç çš„ç®¡ç†å‘˜è´¦å·ã€‚å¦‚æœä½ åœ¨éƒ¨ç½²å‰å·²æŒ‰ç…§æ­¥éª¤ 3 ä¿®æ”¹äº†å¯†ç ï¼Œè¯·ä½¿ç”¨ä½ è®¾ç½®çš„å¯†ç ç™»å½•ã€‚

- ç”¨æˆ·å: `admin`
- å¯†ç : `admin123` (é»˜è®¤å€¼ï¼Œå»ºè®®åœ¨éƒ¨ç½²å‰ä¿®æ”¹)

**ä¿®æ”¹ä½ç½®**: `worker/src/routes/auth.js` (ä¹Ÿå¯ä»¥ç›´æ¥åˆ é™¤é‚£æ®µç¡¬ç¼–ç é€»è¾‘ï¼Œæ”¹ç”¨æ•°æ®åº“æ³¨å†Œçš„ç®¡ç†å‘˜)

### æ³¨å†Œæ–°ç”¨æˆ·
è®¿é—®ä½ éƒ¨ç½²çš„ç½‘ç«™ï¼Œåœ¨ç™»å½•é¡µç‚¹å‡»"ç«‹å³æ³¨å†Œ"å³å¯åˆ›å»ºä¸€ä¸ªæ–°ç”¨æˆ· (é»˜è®¤ä¸ºæ™®é€šç”¨æˆ·æƒé™)ã€‚

## ğŸ“ ç›®å½•ç»“æ„
```
.
â”œâ”€â”€ frontend/             # é™æ€å‰ç«¯é¡µé¢
â”‚   â”œâ”€â”€ config.js         # â­ APIé…ç½®ï¼ˆåªéœ€ä¿®æ”¹æ­¤æ–‡ä»¶ï¼‰
â”‚   â”œâ”€â”€ index.html        # ä¸»é¢æ¿
â”‚   â”œâ”€â”€ admin.html        # ç®¡ç†å‘˜åå°
â”‚   â”œâ”€â”€ app.js            # å‰ç«¯é€»è¾‘
â”‚   â””â”€â”€ ...
â”œâ”€â”€ worker/               # Cloudflare Worker åç«¯
â”‚   â”œâ”€â”€ src/              # æºä»£ç 
â”‚   â”‚   â”œâ”€â”€ index.js      # å…¥å£
â”‚   â”‚   â””â”€â”€ routes/       # API è·¯ç”±
â”‚   â””â”€â”€ wrangler.toml     # Worker é…ç½®
â”œâ”€â”€ schema.sql            # æ•°æ®åº“ç»“æ„
â””â”€â”€ README.md             # æœ¬æ–‡æ¡£
```
